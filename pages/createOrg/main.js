require("../../common/manifest.js"),require("../../common/vendor.js"),global.webpackJsonpMpvue([2],{"1O1G":function(e,t,s){t.a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"show",rawName:"v-show",value:this.visible,expression:"visible"}],staticClass:"show-demo-wrapper"},[t("div",{staticClass:"zoomIn animated"},[this.ossImageUrl?t("img",{staticClass:"demo-img",attrs:{src:"https://miaogeban.oss-cn-shenzhen.aliyuncs.com/images_miaogeban/license-demo.jpg",alt:"",mode:"widthFix"}}):this._e(),this._v(" "),t("img",{staticClass:"close-demo",attrs:{src:"/static/images/Icons/landscape_close.png",alt:"",eventid:"0"},on:{click:this.closeDemo}})])])},staticRenderFns:[]}},"4wry":function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var a=s("5nAL"),i=s.n(a),o=s("ErXA");new i.a(o.a).$mount()},"81LT":function(e,t,s){var a=s("Dd8w"),i=s.n(a),o=s("YELd"),n=s("ka2y"),r=s("NYxO"),m=s("gyMJ"),c=s("p5Kd"),l=s("0xDb"),u=s("uzBN");t.a={name:"CreateOrg",components:{bottomToast:o.a,showDemo:n.a},computed:i()({},Object(r.b)(["baseInfo"])),data:function(){return{type:null,code:"",btnFlag:0,form:{name:"",username:"",mobile:"",businessPic:"",idCardPic:""},mobileBtnText:"获取手机号",timer:null}},onLoad:function(e){var t=this;if(this.type=e.type||null,wx.login({success:function(e){t.code=e.code},fail:function(){},complete:function(){}}),wx.setNavigationBarTitle({title:"创建机构"}),e.type)return Object(c.j)(this.baseInfo.org.id).then((function(e){t.form={name:e.data.name,username:e.data.username,mobile:e.data.mobile,businessPic:e.data.businessPic,idCardPic:e.data.idCardPic}})),void wx.setNavigationBarTitle({title:"机构认证信息"});this.baseInfo.org&&this.baseInfo.org.id&&Object(c.j)(this.baseInfo.org.id).then((function(e){t.form={name:e.data.name,username:e.data.username,mobile:e.data.mobile,businessPic:e.data.businessPic,idCardPic:e.data.idCardPic}})),this.baseInfo.userInfo.mobile&&(this.form.mobile=this.baseInfo.userInfo.mobile),this.baseInfo.userInfo.username&&(this.form.username=this.baseInfo.userInfo.username)},methods:{formSubmit:function(){if(this.form.name)if(this.form.username)if(this.form.mobile){if(1===this.btnFlag)return;this.btnFlag=1,this.handleFun()}else this.showToast("请获取您的手机号！");else this.showToast("请输入您的姓名！");else this.showToast("请输入企业简称！")},handleFun:function(){var e=this;Object(c.d)(this.form).then((function(t){0===t.code?(wx.showToast({title:"提交成功",icon:"success",duration:1500,mask:!0,success:function(e){}}),setTimeout((function(){wx.navigateBack({delta:1}),e.btnFlag=0}),1500)):20001===t.code?e.$store.dispatch("baseInfo/login").then((function(t){e.handleFun()})):(e.showToast(t.msg),e.btnFlag=0)})).catch((function(){e.btnFlag=0}))},getPhoneNumber:function(e){var t=this;if("getPhoneNumber:ok"===e.mp.detail.errMsg){var s=60;this.mobileBtnText="60s",this.timer=setInterval((function(){s--,t.mobileBtnText=s+"s",s<0&&(t.mobileBtnText="获取手机号",clearInterval(t.timer))}),1e3);var a={code:this.code,iv:e.mp.detail.iv,encryptedData:e.mp.detail.encryptedData};Object(m.t)(a).then((function(e){0===e.code&&(t.form.mobile=e.data.mobile)}))}},upLoadPic:function(e){var t=this;console.log(e),wx.chooseImage({count:"1",sizeType:["original"],sourceType:["album","camera"],success:function(s){if(console.log(s),s.tempFiles[0].size/1024/1024>8)t.showToast("请上传8M以内的图片");else{var a=s.tempFilePaths[0].split("."),i=a[a.length-1].toLowerCase();"jpg"===i||"png"===i||"jpeg"===i?(wx.showLoading({title:"上传中..."}),t.uploadImg(s.tempFiles[0].path,e)):t.showToast("请上传jpg，jpeg，png格式图片")}},fail:function(){},complete:function(){}})},uploadImg:function(e,t){var s=this,a=Object(l.b)();wx.getImageInfo({src:e,success:function(i){"unknown"!==i.type?Object(u.b)().then((function(o){var n=o;wx.uploadFile({url:n.host,filePath:e,name:"file",formData:{key:n.dir+"/"+a+"."+i.type,policy:n.policy,OSSAccessKeyId:n.accessid,callback:n.callback,signature:n.signature},success:function(e){if(wx.hideLoading(),200===e.statusCode){var a=JSON.parse(e.data);s.form[t]=a.filename}else s.showToast("上传失败")},fail:function(e){wx.hideLoading(),console.log(e)}})})):s.showToast("请上传jpg，jpeg，png格式图片")}})},showDemo:function(e){this.$refs.showDemo.showDemo(e)},showToast:function(e){this.$refs.bottomToast.showToast(e)}},onUnload:function(){clearInterval(this.timer)},onShareAppMessage:function(){return{title:this.$store.state.sysParams.shareText,path:"/pages/index/main",imageUrl:this.$store.state.sysParams.sharePic,success:function(e){},fail:function(){},complete:function(){}}}}},ARRX:function(e,t){},ErXA:function(e,t,s){var a=s("81LT"),i=s("tVA7"),o=s("ybqe")(a.a,i.a,(function(e){s("ARRX")}),"data-v-27b3743e",null);t.a=o.exports},aPb9:function(e,t){},ka2y:function(e,t,s){var a=s("xwmd"),i=s("1O1G"),o=s("ybqe")(a.a,i.a,(function(e){s("aPb9")}),"data-v-724ac43b",null);t.a=o.exports},tVA7:function(e,t,s){t.a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container-wrapper"},[e.type?e.type?s("section",[s("div",{staticClass:"form-item-wrapper margin-top-20"},[s("div",{staticClass:"form-title"},[e._v("基本信息")]),e._v(" "),s("div",{staticClass:"form-item flex-space"},[s("span",[e._v("机构简称：")]),e._v(" "),s("div",[e._v(e._s(e.form.name))])]),e._v(" "),s("div",{staticClass:"form-item flex-space"},[s("span",[e._v("管理员姓名：")]),e._v(" "),s("div",[e._v(e._s(e.form.username))])]),e._v(" "),s("div",{staticClass:"form-item flex-space"},[s("span",[e._v("管理员手机号：")]),e._v(" "),e.form.mobile?s("div",[e._v(e._s(e.form.mobile))]):e._e()])]),e._v(" "),e.form.businessPic?s("div",{staticClass:"form-item-wrapper margin-top-20"},[s("div",{staticClass:"form-title"},[e._v("营业执照")]),e._v(" "),s("div",{staticClass:"img-wrapper flex-box"},[e.form.businessPic?s("img",{staticStyle:{height:"100%"},attrs:{src:e.form.businessPic,mode:"heightFix"}}):e._e()])]):e._e()]):e._e():s("form",{attrs:{eventid:"5"},on:{submit:e.formSubmit}},[s("div",{staticClass:"form-item-wrapper margin-top-20"},[s("div",{staticClass:"form-item flex-box-start"},[s("span",[e._v("机构简称：")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],attrs:{type:"text",placeholder:"如：新东方教育","placeholder-class":"placeholderStyle",eventid:"0"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||(e.form.name=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"form-item-wrapper margin-top-20"},[s("div",{staticClass:"form-item flex-box-start"},[s("span",[e._v("您的姓名：")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.username,expression:"form.username"}],attrs:{type:"text",placeholder:"请输入您的姓名","placeholder-class":"placeholderStyle",eventid:"1"},domProps:{value:e.form.username},on:{input:function(t){t.target.composing||(e.form.username=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-item flex-box-start"},[s("span",[e._v("您的手机号：")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.mobile,expression:"form.mobile"}],staticStyle:{width:"52%"},attrs:{type:"number",placeholder:"请获取您的手机号",disabled:"","placeholder-class":"placeholderStyle",eventid:"2"},domProps:{value:e.form.mobile},on:{input:function(t){t.target.composing||(e.form.mobile=t.target.value)}}}),e._v(" "),s("button",{staticClass:"getPhoneNumberBtn",class:"获取手机号"==e.mobileBtnText?"":"disableBtn",attrs:{"open-type":"getPhoneNumber",disabled:"获取手机号"!=e.mobileBtnText,eventid:"3"},on:{getphonenumber:e.getPhoneNumber}},[e._v("\n          "+e._s(e.mobileBtnText)+"\n        ")]),e._v(" "),s("button",{staticClass:"getPhoneNumberPos",attrs:{"open-type":"getPhoneNumber",disabled:"获取手机号"!=e.mobileBtnText,eventid:"4"},on:{getphonenumber:e.getPhoneNumber}})],1),e._v(" "),s("div",{staticClass:"remind flex-box-start"},[s("img",{attrs:{src:"../../../static/images/Icons/remind.png",alt:""}}),e._v(" "),s("div",[e._v("创建者将作为机构管理员(拥有最高权限)"),s("button",{staticStyle:{color:"#003399"},attrs:{"open-type":"share"}},[e._v("邀请校长来创建")])],1)])]),e._v(" "),s("p",{staticClass:"copyright"},[e._v("您的机构信息将严格保密,请您放心。")]),e._v(" "),s("button",{staticClass:"submit-btn btn-liner",attrs:{formType:"submit"}},[e._v("立即提交")])],1),e._v(" "),s("bottom-toast",{ref:"bottomToast",attrs:{mpcomid:"0"}}),e._v(" "),s("show-demo",{ref:"showDemo",attrs:{mpcomid:"1"}})],1)},staticRenderFns:[]}},xwmd:function(e,t,s){var a=s("IcnI").a.state.ossImageUrl;t.a={name:"ShowDemo",data:function(){return{ossImageUrl:a,visible:!1,demoType:"id"}},methods:{showDemo:function(e){this.demoType=e,this.visible=!0},closeDemo:function(){this.visible=!1}}}}},["4wry"]);